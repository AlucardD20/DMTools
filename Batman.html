<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DC Heroes Action & Results</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e1e;
            color: #f5f5f5;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        h1 {
            margin: 20px 0;
        }
        .container {
            margin: 20px auto;
            width: 80%;
            max-width: 800px;
        }
        select, button {
            padding: 10px;
            margin: 10px 5px;
            font-size: 16px;
        }
        #log {
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #2e2e2e;
            text-align: left;
            overflow-y: auto;
            height: 300px;
        }
        .log-entry {
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #0056b3;
            color: #fff;
        }
    </style>
</head>
<body>
    <h1>DC Heroes Action & Results</h1>
    <p style="margin: 20px auto; padding: 10px; border: 1px solid #ccc; border-radius: 10px; background-color: #2e2e2e; text-align: center; width: 80%;">
        Enter the Acting and Opposing values, then roll dice to determine the outcome. The column shifts will automatically adjust the results table for effect and resistance values. Logs can be downloaded when finished.
    </p>
    <div class="container">
        <label for="actingValue">Acting Value:</label>
        <select id="actingValue">
            <option value="">Select...</option>
            <option value="1">1-2</option>
            <option value="3">3-4</option>
            <option value="5">5-6</option>
            <option value="7">7-8</option>
            <option value="9">9-10</option>
            <option value="11">11-12</option>
            <option value="13">13-15</option>
            <option value="16">16-18</option>
            <option value="19">19-21</option>
            <option value="22">22-24</option>
        </select>
        <label for="opposingValue">Opposing Value:</label>
        <select id="opposingValue">
            <option value="">Select...</option>
            <option value="1">1-2</option>
            <option value="3">3-4</option>
            <option value="5">5-6</option>
            <option value="7">7-8</option>
            <option value="9">9-10</option>
            <option value="11">11-12</option>
            <option value="13">13-15</option>
            <option value="16">16-18</option>
            <option value="19">19-21</option>
            <option value="22">22-24</option>
        </select>
        <br>
        <button onclick="rollDice()">Roll Dice</button>
        <button onclick="downloadLog()">Download Log</button>
        <div id="log"></div>
    </div>

    <script>
        const log = [];

        function rollDice() {
    const actingValue = parseInt(document.getElementById("actingValue").value);
    const opposingValue = parseInt(document.getElementById("opposingValue").value);

    if (isNaN(actingValue) || isNaN(opposingValue)) {
        alert("Please select both Acting and Opposing values.");
        return;
    }

    // Define action table thresholds
    const actionTable = [11, 13, 15, 17, 19, 21, 23, 25]; // Example chart ranges

    let rollTotal = 0;
    let rolls = [];
    let isDoubles = false;

    do {
        const die1 = Math.floor(Math.random() * 10) + 1;
        const die2 = Math.floor(Math.random() * 10) + 1;
        rolls.push(die1 + die2);
        rollTotal += die1 + die2;
        isDoubles = die1 === die2 && die1 !== 1;
    } while (isDoubles);

    const actionValue = rollTotal + actingValue - opposingValue;
    let columnShifts = 0;
    let result;

    // Determine column shifts based on the action table
    for (let i = 0; i < actionTable.length; i++) {
        if (actionValue >= actionTable[i]) {
            columnShifts = i; // Match the shift index
        } else {
            break;
        }
    }

    if (columnShifts === 0 && actionValue < actionTable[0]) {
        result = "Fail";
    } else {
        result = `Success with ${columnShifts} column shift${columnShifts > 1 ? "s" : ""}`;
    }

    addToLog(`Rolls: ${rolls.join(", ")} | Total: ${rollTotal} | Action Value: ${actionValue} | Result: ${result}`);
}

    let rollTotal = 0;
    let rolls = [];
    let isDoubles = false;

    do {
        const die1 = Math.floor(Math.random() * 10) + 1;
        const die2 = Math.floor(Math.random() * 10) + 1;
        rolls.push(die1 + die2);
        rollTotal += die1 + die2;
        isDoubles = die1 === die2 && die1 !== 1;
    } while (isDoubles);

    const actionValue = rollTotal + actingValue - opposingValue;
    let columnShifts = 0;
    let result;

    // Start column shifts at 13
    if (actionValue >= 13) {
        columnShifts = Math.floor((actionValue - 13) / 2) + 1;
        result = `Success with ${columnShifts} column shift${columnShifts > 1 ? "s" : ""}`;
    } else {
        result = "Fail";
    }

    addToLog(`Rolls: ${rolls.join(", ")} | Total: ${rollTotal} | Action Value: ${actionValue} | Result: ${result}`);
}

    let rollTotal = 0;
    let rolls = [];
    let isDoubles = false;

    do {
        const die1 = Math.floor(Math.random() * 10) + 1;
        const die2 = Math.floor(Math.random() * 10) + 1;
        rolls.push(die1 + die2);
        rollTotal += die1 + die2;
        isDoubles = die1 === die2 && die1 !== 1;
    } while (isDoubles);

    const actionValue = rollTotal + actingValue - opposingValue;
    let result;
    let columnShifts = 0;

    if (actionValue < actionTableBase) {
        result = "Fail";
    } else {
        columnShifts = actionValue - actionTableBase;
        result = `Success with ${columnShifts} column shift${columnShifts > 1 ? "s" : ""}`;
    }

    addToLog(`Rolls: ${rolls.join(", ")} | Total: ${rollTotal} | Action Value: ${actionValue} | Result: ${result}`);
}

            let rollTotal = 0;
            let rolls = [];
            let isDoubles = false;

            do {
                const die1 = Math.floor(Math.random() * 10) + 1;
                const die2 = Math.floor(Math.random() * 10) + 1;
                rolls.push(die1 + die2);
                rollTotal += die1 + die2;
                isDoubles = die1 === die2 && die1 !== 1;
            } while (isDoubles);

            const actionValue = rollTotal + actingValue - opposingValue;
            let result;
            let columnShifts = 0;

            if (actionValue < actionTableBase) {
                result = "Fail";
            } else {
                columnShifts = Math.max(0, actionValue - actionTableBase);
                result = `Success with ${columnShifts} column shift${columnShifts > 1 ? 's' : ''}`;
            }
            const columnShifts = Math.max(0, actionValue - 11);

            addToLog(`Rolls: ${rolls.join(", ")} | Total: ${rollTotal} | Action Value: ${actionValue} | Result: ${result}`);
        }

        function addToLog(entry) {
            log.push(entry);
            const logDiv = document.getElementById("log");
            logDiv.innerHTML += `<div class='log-entry'>${entry}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function downloadLog() {
            const logContent = log.join("\n");
            const blob = new Blob([logContent], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "dc_heroes_log.txt";
            link.click();
        }
    </script>
</body>
</html>
